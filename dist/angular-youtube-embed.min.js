/*
  angular-youtube-mb v1.0.2
  https://github.com/brandly/angular-youtube-embed
*/
angular.module("youtube-embed",["ng"]).service("youtubeEmbedUtils",["$window","$rootScope",function(e,r){function t(e,r){return e.indexOf(r)>-1}function a(){r.$apply(function(){i.ready=!0})}var i={},n=/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube(?:-nocookie)?\.com\S*[^\w\s-])([\w-]{11})(?=[^\w-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,o=/t=(\d+)[ms]?(\d+)?s?/;return i.getIdFromURL=function(e){var r=e.replace(n,"$1");if(t(r,";")){var a=r.split(";");if(t(a[1],"%")){var i=decodeURIComponent(r.split(";")[1]);r=("http://youtube.com"+i).replace(n,"$1")}else r=a[0]}else t(r,"#")&&(r=r.split("#")[0]);return r},i.getTimeFromURL=function(e){e=e||"";var r=e.match(o);if(!r)return 0;var a=r[0],i=r[1],n=r[2];return"undefined"!=typeof n?(n=parseInt(n,10),i=parseInt(i,10)):t(a,"m")?(i=parseInt(i,10),n=0):(n=parseInt(i,10),i=0),n+60*i},i.ready=!1,"undefined"==typeof YT?e.onYouTubeIframeAPIReady=a:YT.loaded?i.ready=!0:YT.ready(a),i}]).directive("youtubeVideo",["youtubeEmbedUtils","$parse",function(e,r){var t=1,a={"-1":"unstarted",0:"ended",1:"playing",2:"paused",3:"buffering",5:"queued"},i="youtube.player.";return{restrict:"EA",scope:{videoId:"=?",videoUrl:"=?",player:"=?",playerVars:"=?",playerHeight:"=?",playerWidth:"=?"},link:function(n,o,d){function l(){var e=Array.prototype.slice.call(arguments);n.$apply(function(){n.$emit.apply(n,e)})}function u(e){var r=a[e.data];"undefined"!=typeof r&&l(i+r,n.player,e),n.$apply(function(){n.player.currentState=r})}function p(e){l(i+"ready",n.player,e)}function y(e){l(i+"error",n.player,e)}function s(){var e=angular.copy(n.playerVars);e.start=e.start||n.urlStartTime;var r=new YT.Player(h,{height:n.playerHeight,width:n.playerWidth,videoId:n.videoId,playerVars:e,events:{onReady:p,onStateChange:u,onError:y}});return r.id=h,r}function c(){(n.videoId||n.playerVars.list)&&(n.player&&"function"==typeof n.player.destroy&&n.player.destroy(),n.player=s())}var f=r(d.startWithImage)();if(f===!0){var v=o.wrap('<div ng-show="hideOverlay"></div>');v.after('<div class="image-wrapper" ng-click="hideOverlay = true; player.playVideo()" ng-show="!hideOverlay"><img ng-src="http://img.youtube.com/vi/{{post.videoId}}/0.jpg"><div></div></div>')}n.utils=e;var h=d.playerId||o[0].id||"unique-youtube-embed-id-"+t++;o[0].id=h,n.playerHeight=n.playerHeight||390,n.playerWidth=n.playerWidth||640,n.playerVars=n.playerVars||{};var m=n.$watch(function(){return n.utils.ready&&("undefined"!=typeof n.videoUrl||"undefined"!=typeof n.videoId||"undefined"!=typeof n.playerVars.list)},function(e){e&&(m(),"undefined"!=typeof n.videoUrl?n.$watch("videoUrl",function(e){n.videoId=n.utils.getIdFromURL(e),n.urlStartTime=n.utils.getTimeFromURL(e),c()}):"undefined"!=typeof n.videoId?n.$watch("videoId",function(){n.urlStartTime=null,c()}):n.$watch("playerVars.list",function(){n.urlStartTime=null,c()}))});n.$watchCollection(["playerHeight","playerWidth"],function(){n.player&&n.player.setSize(n.playerWidth,n.playerHeight)}),n.$on("$destroy",function(){n.player&&n.player.destroy()})}}}]);