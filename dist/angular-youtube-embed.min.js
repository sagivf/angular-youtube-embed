/*
  angular-youtube-mb v1.1.1
  https://github.com/brandly/angular-youtube-embed
*/
angular.module("youtube-embed",["ng"]).service("youtubeEmbedUtils",["$window","$rootScope",function(e,r){function t(e,r){return e.indexOf(r)>-1}function a(){r.$apply(function(){i.ready=!0})}var i={},n=/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube(?:-nocookie)?\.com\S*[^\w\s-])([\w-]{11})(?=[^\w-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,o=/t=(\d+)[ms]?(\d+)?s?/;return i.getIdFromURL=function(e){var r=e.replace(n,"$1");if(t(r,";")){var a=r.split(";");if(t(a[1],"%")){var i=decodeURIComponent(a[1]);r=("http://youtube.com"+i).replace(n,"$1")}else r=a[0]}else t(r,"#")&&(r=r.split("#")[0]);return r},i.getTimeFromURL=function(e){e=e||"";var r=e.match(o);if(!r)return 0;var a=r[0],i=r[1],n=r[2];return"undefined"!=typeof n?(n=parseInt(n,10),i=parseInt(i,10)):t(a,"m")?(i=parseInt(i,10),n=0):(n=parseInt(i,10),i=0),n+60*i},i.ready=!1,"undefined"==typeof YT?e.onYouTubeIframeAPIReady=a:YT.loaded?i.ready=!0:YT.ready(a),i}]).directive("youtubeVideo",["youtubeEmbedUtils","$compile","$parse",function(e,r,t){var a=1,i={"-1":"unstarted",0:"ended",1:"playing",2:"paused",3:"buffering",5:"queued"},n="youtube.player.";return{restrict:"EA",scope:{videoId:"=?",videoUrl:"=?",player:"=?",playerVars:"=?",playerHeight:"=?",playerWidth:"=?"},link:function(o,d,l){function u(){var e=Array.prototype.slice.call(arguments);o.$apply(function(){o.$emit.apply(o,e)})}function y(e){var r=i[e.data];"undefined"!=typeof r&&u(n+r,o.player,e),o.$apply(function(){o.player.currentState=r})}function p(e){u(n+"ready",o.player,e)}function c(e){u(n+"error",o.player,e)}function s(){var e=angular.copy(o.playerVars);e.start=e.start||o.urlStartTime;var r=new YT.Player(m,{height:o.playerHeight,width:o.playerWidth,videoId:o.videoId,playerVars:e,events:{onReady:p,onStateChange:y,onError:c}});return r.id=m,r}function f(){(o.videoId||o.playerVars.list)&&(o.player&&"function"==typeof o.player.destroy&&o.player.destroy(),o.player=s())}var v=t(l.startWithImage)();if(v===!0){var g=r(angular.element('<div ng-show="hideOverlay"></div>'))(o),h=r(angular.element('<div class="image-wrapper" ng-click="imageClicked()" ng-show="!hideOverlay"><img ng-src="http://img.youtube.com/vi/{{videoId}}/0.jpg" ng-style="{ \'height\': playerHeight + \'px\' }"><div></div></div>'))(o);d.wrap(g),g.after(h)}o.imageClicked=function(){o.hideOverlay=!0,playerReady.promise.then(function(){o.player.playVideo()})},o.utils=e;var m=l.playerId||d[0].id||"unique-youtube-embed-id-"+a++;d[0].id=m,o.playerHeight=o.playerHeight||390,o.playerWidth=o.playerWidth||640,o.playerVars=o.playerVars||{};var I=o.$watch(function(){return o.utils.ready&&("undefined"!=typeof o.videoUrl||"undefined"!=typeof o.videoId||"undefined"!=typeof o.playerVars.list)},function(e){e&&(I(),"undefined"!=typeof o.videoUrl?o.$watch("videoUrl",function(e){o.videoId=o.utils.getIdFromURL(e),o.urlStartTime=o.utils.getTimeFromURL(e),f()}):"undefined"!=typeof o.videoId?o.$watch("videoId",function(){o.urlStartTime=null,f()}):o.$watch("playerVars.list",function(){o.urlStartTime=null,f()}))});o.$watchCollection(["playerHeight","playerWidth"],function(){o.player&&o.player.setSize(o.playerWidth,o.playerHeight)}),o.$on("$destroy",function(){o.player&&o.player.destroy()})}}}]);