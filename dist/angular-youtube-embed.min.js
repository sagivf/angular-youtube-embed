/*
  angular-youtube-mb v1.1.1
  https://github.com/brandly/angular-youtube-embed
*/
angular.module("youtube-embed",["ng"]).service("youtubeEmbedUtils",["$window","$rootScope",function(e,t){function r(e,t){return e.indexOf(t)>-1}function i(){t.$apply(function(){a.ready=!0})}var a={},n=/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube(?:-nocookie)?\.com\S*[^\w\s-])([\w-]{11})(?=[^\w-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,l=/t=(\d+)[ms]?(\d+)?s?/;return a.getIdFromURL=function(e){var t=e.replace(n,"$1");if(r(t,";")){var i=t.split(";");if(r(i[1],"%")){var a=decodeURIComponent(i[1]);t=("http://youtube.com"+a).replace(n,"$1")}else t=i[0]}else r(t,"#")&&(t=t.split("#")[0]);return t},a.getTimeFromURL=function(e){e=e||"";var t=e.match(l);if(!t)return 0;var i=t[0],a=t[1],n=t[2];return"undefined"!=typeof n?(n=parseInt(n,10),a=parseInt(a,10)):r(i,"m")?(a=parseInt(a,10),n=0):(n=parseInt(a,10),a=0),n+60*a},a.ready=!1,"undefined"==typeof YT?e.onYouTubeIframeAPIReady=i:YT.loaded?a.ready=!0:YT.ready(i),a}]).directive("youtubeVideo",["youtubeEmbedUtils","$compile","$parse","$q",function(e,t,r,i){var a=1,n={"-1":"unstarted",0:"ended",1:"playing",2:"paused",3:"buffering",5:"queued"},l="youtube.player.";return{restrict:"EA",scope:{videoId:"=?",videoUrl:"=?",player:"=?",playerVars:"=?",playerHeight:"=?",playerWidth:"=?"},link:function(o,u,d){function p(){var e=Array.prototype.slice.call(arguments);o.$apply(function(){o.$emit.apply(o,e)})}function y(e){var t=n[e.data];"undefined"!=typeof t&&p(l+t,o.player,e),o.$apply(function(){o.player.currentState=t})}function s(e){p(l+"ready",o.player,e),v.resolve()}function c(e){p(l+"error",o.player,e)}function h(){var e=angular.copy(o.playerVars);e.start=e.start||o.urlStartTime;var t=new YT.Player(m,{height:o.playerHeight||"100%",width:o.playerWidth||"100%",videoId:o.videoId,playerVars:e,events:{onReady:s,onStateChange:y,onError:c}});return t.id=m,t}function f(){(o.videoId||o.playerVars.list)&&(o.player&&"function"==typeof o.player.destroy&&o.player.destroy(),o.player=h())}o.showThumbnail=!1;var m=d.playerId||u[0].id||"unique-youtube-embed-id-"+a++,v=i.defer(),g=r(d.thumbnail)();if(g||0===g){"number"!=typeof g&&(g=0),o.showThumbnail=!0;var b=t(angular.element('<div ng-click="imageClicked()" ng-class="{ thumbnail: showThumbnail }" class="angular-youtube-wrapper" ng-style="{ height:  thumbnail ? thumbnail + \'px\' : null, width: playerWidth ? playerWidth + \'px\' : null  }"><img ng-show="showThumbnail" class="'+d.class+'" ng-src="http://img.youtube.com/vi/{{videoId}}/{{'+g+'}}.jpg" height="{{playerHeight ? playerHeight + \'px\' : null}}" width="{{playerWidth ? playerWidth +  \'px\' : null}}"><div ng-show="!showThumbnail" class="'+d.class+'"><div id="'+m+'"></div></div></div>'))(o);u.append(b)}else u[0].id=m;o.imageClicked=function(){v.promise.then(function(){o.player.playVideo(),o.showThumbnail=!1})},o.utils=e,o.playerVars=o.playerVars||{};var w=o.$watch(function(){return o.utils.ready&&("undefined"!=typeof o.videoUrl||"undefined"!=typeof o.videoId||"undefined"!=typeof o.playerVars.list)},function(e){e&&(w(),"undefined"!=typeof o.videoUrl?o.$watch("videoUrl",function(e){o.videoId=o.utils.getIdFromURL(e),o.urlStartTime=o.utils.getTimeFromURL(e),f()}):"undefined"!=typeof o.videoId?o.$watch("videoId",function(){o.urlStartTime=null,f()}):o.$watch("playerVars.list",function(){o.urlStartTime=null,f()}))});o.$watchCollection(["playerHeight","playerWidth"],function(){o.player&&o.playerWidth&&o.playerHeight&&o.player.setSize(o.playerWidth,o.playerHeight)}),o.$on("$destroy",function(){o.player&&o.player.destroy()})}}}]);