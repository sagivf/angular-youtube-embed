/*
  angular-youtube-mb v1.0.2
  https://github.com/brandly/angular-youtube-embed
*/
angular.module("youtube-embed",["ng"]).service("youtubeEmbedUtils",["$window","$rootScope",function(e,r){function t(e,r){return e.indexOf(r)>-1}function i(){r.$apply(function(){a.ready=!0})}var a={},n=/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube(?:-nocookie)?\.com\S*[^\w\s-])([\w-]{11})(?=[^\w-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,o=/t=(\d+)[ms]?(\d+)?s?/;return a.getIdFromURL=function(e){var r=e.replace(n,"$1");if(t(r,";")){var i=r.split(";");if(t(i[1],"%")){var a=decodeURIComponent(r.split(";")[1]);r=("http://youtube.com"+a).replace(n,"$1")}else r=i[0]}else t(r,"#")&&(r=r.split("#")[0]);return r},a.getTimeFromURL=function(e){e=e||"";var r=e.match(o);if(!r)return 0;var i=r[0],a=r[1],n=r[2];return"undefined"!=typeof n?(n=parseInt(n,10),a=parseInt(a,10)):t(i,"m")?(a=parseInt(a,10),n=0):(n=parseInt(a,10),a=0),n+60*a},a.ready=!1,"undefined"==typeof YT?e.onYouTubeIframeAPIReady=i:YT.loaded?a.ready=!0:YT.ready(i),a}]).directive("youtubeVideo",["youtubeEmbedUtils","$parse","$compile","$q",function(e,r,t,i){var a=1,n={"-1":"unstarted",0:"ended",1:"playing",2:"paused",3:"buffering",5:"queued"},o="youtube.player.";return{restrict:"EA",scope:{videoId:"=?",videoUrl:"=?",player:"=?",playerVars:"=?",playerHeight:"=?",playerWidth:"=?"},link:function(d,l,u){function p(){var e=Array.prototype.slice.call(arguments);d.$apply(function(){d.$emit.apply(d,e)})}function y(e){var r=n[e.data];"undefined"!=typeof r&&p(o+r,d.player,e),d.$apply(function(){d.player.currentState=r})}function c(e){p(o+"ready",d.player,e),g.resolve()}function s(e){p(o+"error",d.player,e)}function f(){var e=angular.copy(d.playerVars);e.start=e.start||d.urlStartTime;var r=new YT.Player($,{height:d.playerHeight,width:d.playerWidth,videoId:d.videoId,playerVars:e,events:{onReady:c,onStateChange:y,onError:s}});return r.id=$,r}function v(){(d.videoId||d.playerVars.list)&&(d.player&&"function"==typeof d.player.destroy&&d.player.destroy(),d.player=f())}var g=i.defer(),h=r(u.startWithImage)();if(h===!0){var m=t(angular.element('<div ng-show="hideOverlay"></div>'))(d),I=t(angular.element('<div class="image-wrapper" ng-click="imageClicked()" ng-show="!hideOverlay"><img ng-src="http://img.youtube.com/vi/{{videoId}}/0.jpg" ng-style="{ \'height\': playerHeight + \'px\' }"><div></div></div>'))(d);l.wrap(m),m.after(I)}d.playerHeight=d.playerHeight||390,d.playerWidth=d.playerWidth||640,d.playerVars=d.playerVars||{},d.utils=e;var $=u.playerId||l[0].id||"unique-youtube-embed-id-"+a++;l[0].id=$,d.imageClicked=function(){d.hideOverlay=!0,g.promise.then(function(){d.player.playVideo()})};var w=d.$watch(function(){return d.utils.ready&&("undefined"!=typeof d.videoUrl||"undefined"!=typeof d.videoId||"undefined"!=typeof d.playerVars.list)},function(e){e&&(w(),"undefined"!=typeof d.videoUrl?d.$watch("videoUrl",function(e){d.videoId=d.utils.getIdFromURL(e),d.urlStartTime=d.utils.getTimeFromURL(e),v()}):"undefined"!=typeof d.videoId?d.$watch("videoId",function(){d.urlStartTime=null,v()}):d.$watch("playerVars.list",function(){d.urlStartTime=null,v()}))});d.$watchCollection(["playerHeight","playerWidth"],function(){d.player&&d.player.setSize(d.playerWidth,d.playerHeight)}),d.$on("$destroy",function(){d.player&&d.player.destroy()})}}}]);